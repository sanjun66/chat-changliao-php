(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0afa02"],{"0eb9":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.search}},[a("el-form-item",{attrs:{label:"群ID"}},[a("el-input",{attrs:{clearable:""},model:{value:e.search.id,callback:function(t){e.$set(e.search,"id",t)},expression:"search.id"}})],1),a("el-form-item",{attrs:{label:"群主ID"}},[a("el-input",{attrs:{clearable:""},model:{value:e.search.uid,callback:function(t){e.$set(e.search,"uid",t)},expression:"search.uid"}})],1),a("el-form-item",{attrs:{label:"群名称"}},[a("el-input",{attrs:{clearable:""},model:{value:e.search.name,callback:function(t){e.$set(e.search,"name",t)},expression:"search.name"}})],1),a("el-form-item",{attrs:{label:"是否已解散"}},[a("el-select",{attrs:{clearable:""},model:{value:e.search.is_dismiss,callback:function(t){e.$set(e.search,"is_dismiss",t)},expression:"search.is_dismiss"}},[a("el-option",{attrs:{label:"否",value:"0"}}),a("el-option",{attrs:{label:"是",value:"1"}})],1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("查询")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.list,border:""}},[a("el-table-column",{attrs:{prop:"id",label:"ID",width:"70"}}),a("el-table-column",{attrs:{prop:"uid",width:"70",label:"群主ID"}}),a("el-table-column",{attrs:{prop:"name",label:"群名称"}}),a("el-table-column",{attrs:{prop:"avatar",label:"头像",width:"120"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("el-avatar",{attrs:{size:"large",src:e.row.avatar}})]}}])}),a("el-table-column",{attrs:{prop:"is_mute",label:"是否禁言",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==t.row.is_mute?a("el-tag",{attrs:{type:"success"}},[e._v("否")]):a("el-tag",{attrs:{type:"danger"}},[e._v("是")])]}}])}),a("el-table-column",{attrs:{prop:"max_num",label:"最大人数",width:"80"}}),a("el-table-column",{attrs:{prop:"is_dismiss",label:"是否解散",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==t.row.is_dismiss?a("el-tag",{attrs:{type:"success"}},[e._v("否")]):a("el-tag",{attrs:{type:"danger"}},[e._v("是")])]}}])}),a("el-table-column",{attrs:{prop:"describe",label:"群描述"}}),a("el-table-column",{attrs:{prop:"updated_at",label:"更新时间",width:"160"}}),a("el-table-column",{attrs:{prop:"dismissed_at",label:"解散时间",width:"160"}}),a("el-table-column",{attrs:{prop:"created_at",label:"创建时间",width:"160"}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"170"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.showGroupInfo(t.$index,t.row)}}},[e._v("编辑")]),a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.showGroupMessage(t.row)}}},[e._v("聊天记录 ")]),a("el-button",{staticStyle:{"margin-left":"0px","margin-top":"10px"},attrs:{size:"mini"},on:{click:function(a){return e.showGroupUsers(t.$index,t.row)}}},[e._v("群成员 ")]),a("el-button",{staticStyle:{"margin-top":"10px"},attrs:{size:"mini"},on:{click:function(a){return e.showGroupNotice(t.row)}}},[e._v("群公告 ")])]}}])})],1),a("div",{staticStyle:{margin:"20px 0","text-align":"center"}},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next","current-page":e.search.page,"page-size":e.pages.limit,total:e.pages.total},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){return e.$set(e.search,"page",t)},"update:current-page":function(t){return e.$set(e.search,"page",t)}}})],1),a("el-dialog",{attrs:{title:"群组成员",visible:e.userListVisible,top:"2vh"},on:{"update:visible":function(t){e.userListVisible=t}}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.userLoading,expression:"userLoading"}],attrs:{data:e.userList}},[a("el-table-column",{attrs:{property:"uid",label:"用户ID"}}),a("el-table-column",{attrs:{property:"notes",label:"昵称"}}),a("el-table-column",{attrs:{property:"avatar",label:"头像",width:"130"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("el-avatar",{attrs:{size:"large",src:e.row.avatar}})]}}])}),a("el-table-column",{attrs:{prop:"is_mute",label:"成员类型",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==t.row.role?a("el-tag",{attrs:{effect:"plain",type:"info"}},[e._v("普通成员")]):2==t.row.role?a("el-tag",{attrs:{effect:"plain",type:"warning"}},[e._v("管理员")]):1==t.row.role?a("el-tag",{attrs:{effect:"plain",type:"success"}},[e._v("群主")]):e._e()]}}])}),a("el-table-column",{attrs:{prop:"is_mute",label:"是否禁言",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==t.row.is_mute?a("el-tag",{attrs:{type:"success"}},[e._v("否")]):1==t.row.is_mute?a("el-tag",{attrs:{type:"danger"}},[e._v("是")]):e._e()]}}])}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popconfirm",{attrs:{title:"确定踢出吗？"},on:{onConfirm:function(a){return e.kickOutGroup(t.$index,t.row)}}},[a("el-button",{staticStyle:{"margin-right":"6px"},attrs:{slot:"reference",size:"mini",type:"danger"},slot:"reference"},[e._v(" 踢出群聊 ")])],1),a("el-button",{attrs:{slot:"reference",size:"mini",type:0==t.row.is_mute?"danger":"primary"},on:{click:function(a){return e.muteMemberGroup(t.row)}},slot:"reference"},[e._v(" "+e._s(0==t.row.is_mute?"禁言":"解除禁言")+" ")]),1!=t.row.role?a("el-button",{staticStyle:{"margin-top":"6px"},attrs:{slot:"reference",size:"mini",type:0==t.row.role?"success":"warning"},on:{click:function(a){return e.groupManager(t.$index,t.row)}},slot:"reference"},[e._v(" "+e._s(0==t.row.role?"添加管理员":"移除管理员")+" ")]):e._e()]}}])})],1)],1),a("el-dialog",{attrs:{title:"群组详情",visible:e.dialogFormVisible,top:"2vh"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{label:"群主ID",prop:"uid","label-width":e.formLabelWidth}},[a("el-input",{model:{value:e.form.uid,callback:function(t){e.$set(e.form,"uid",t)},expression:"form.uid"}})],1),a("el-form-item",{attrs:{label:"群名称",prop:"name","label-width":e.formLabelWidth}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"最大人数",prop:"max_num","label-width":e.formLabelWidth}},[a("el-input",{model:{value:e.form.max_num,callback:function(t){e.$set(e.form,"max_num",t)},expression:"form.max_num"}})],1),a("el-form-item",{attrs:{label:"是否全员禁言",prop:"is_mute","label-width":e.formLabelWidth}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:e.form.is_mute,callback:function(t){e.$set(e.form,"is_mute",t)},expression:"form.is_mute"}})],1),a("el-form-item",{attrs:{label:"群描述","label-width":e.formLabelWidth}},[a("el-input",{attrs:{type:"textarea",autosize:""},model:{value:e.form.describe,callback:function(t){e.$set(e.form,"describe",t)},expression:"form.describe"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.closeVisible()}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",loading:e.loadingBut},on:{click:function(t){return e.submitForm()}}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"聊天记录",width:"90%",visible:e.messageVisible},on:{close:e.closeMessageVisible,"update:visible":function(t){e.messageVisible=t}}},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.msgPages}},[a("el-form-item",{attrs:{label:"关键字"}},[a("el-input",{attrs:{clearable:""},model:{value:e.msgPages.message,callback:function(t){e.$set(e.msgPages,"message",t)},expression:"msgPages.message"}})],1),a("el-form-item",{attrs:{label:"时间范围"}},[a("el-date-picker",{attrs:{type:"daterange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd","picker-options":e.pickerOptions},model:{value:e.dateValue,callback:function(t){e.dateValue=t},expression:"dateValue"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.queryMessage}},[e._v("查询")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.messageLoading,expression:"messageLoading"}],attrs:{data:e.messageList,border:""}},[a("el-table-column",{attrs:{prop:"id",label:"ID",width:"70"}}),a("el-table-column",{attrs:{prop:"from_uid",label:"用户ID",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.from_uid>0?t.row.from_uid:"系统消息")+" ")]}}])}),a("el-table-column",{attrs:{prop:"nick_name",label:"昵称",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.member.nick_name)+" ")]}}])}),a("el-table-column",{attrs:{prop:"message_type",label:"消息类型",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.msgType[t.row.message_type])+" ")]}}])}),a("el-table-column",{attrs:{prop:"message",label:"消息内容"}}),a("el-table-column",{attrs:{prop:"is_revoke",label:"是否撤回",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==t.row.is_revoke?a("el-tag",{attrs:{type:"success"}},[e._v("否")]):1==t.row.is_revoke?a("el-tag",{attrs:{type:"danger"}},[e._v("是")]):e._e()]}}])}),a("el-table-column",{attrs:{prop:"quote_id",label:"引用消息ID",width:"120"}}),a("el-table-column",{attrs:{prop:"is_delete",label:"是否删除",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==t.row.is_delete?a("el-tag",{attrs:{type:"success"}},[e._v("否")]):1==t.row.is_delete?a("el-tag",{attrs:{type:"danger"}},[e._v("是")]):e._e()]}}])}),a("el-table-column",{attrs:{prop:"created_at",label:"发送时间",width:"160"}})],1),a("div",{staticStyle:{margin:"20px 0","text-align":"center"}},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next","current-page":e.msgPages.page,"page-size":e.msgPages.limit,total:e.msgPages.total},on:{"current-change":e.msgeCurrentChange,"update:currentPage":function(t){return e.$set(e.msgPages,"page",t)},"update:current-page":function(t){return e.$set(e.msgPages,"page",t)}}})],1)],1),a("el-dialog",{attrs:{title:"群公告",width:"80%",visible:e.noticeVisible},on:{"update:visible":function(t){e.noticeVisible=t}}},[a("div",{staticStyle:{"padding-bottom":"10px","text-align":"right"}},[a("el-button",{attrs:{type:"success"},on:{click:function(t){return e.onNoticeAddOrUpdate(-1)}}},[e._v("新增")])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.noticeLoading,expression:"noticeLoading"}],attrs:{data:e.noticeList,border:""}},[a("el-table-column",{attrs:{prop:"id",label:"ID",width:"70"}}),a("el-table-column",{attrs:{prop:"title",label:"标题"}}),a("el-table-column",{attrs:{prop:"content",label:"内容"}}),a("el-table-column",{attrs:{prop:"is_top",label:"是否置顶",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==t.row.is_top?a("el-tag",{attrs:{type:"success"}},[e._v("否")]):1==t.row.is_top?a("el-tag",{attrs:{type:"danger"}},[e._v("是")]):e._e()]}}])}),a("el-table-column",{attrs:{prop:"created_at",label:"创建时间",width:"160"}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){return e.onNoticeAddOrUpdate(t.$index,t.row)}}},[e._v(" 编辑 ")]),a("el-popconfirm",{attrs:{title:"确定删除吗？"},on:{onConfirm:function(a){return e.delNoticeGroup(t.$index,t.row)}}},[a("el-button",{staticStyle:{"margin-left":"6px"},attrs:{slot:"reference",size:"mini",type:"danger"},slot:"reference"},[e._v(" 删除 ")])],1)]}}])})],1),a("div",{staticStyle:{margin:"20px 0","text-align":"center"}},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next","current-page":e.noticePages.page,"page-size":e.noticePages.limit,total:e.noticePages.total},on:{"current-change":e.noticeCurrentChange,"update:currentPage":function(t){return e.$set(e.noticePages,"page",t)},"update:current-page":function(t){return e.$set(e.noticePages,"page",t)}}})],1)],1),a("el-dialog",{attrs:{title:e.noticeForm.id>0?"编辑":"添加群公告",visible:e.noticeFormVisible,top:"2vh"},on:{"update:visible":function(t){e.noticeFormVisible=t}}},[a("el-form",{ref:"noticeForm",attrs:{model:e.noticeForm}},[a("el-form-item",{attrs:{label:"标题",prop:"title","label-width":e.formLabelWidth}},[a("el-input",{model:{value:e.noticeForm.title,callback:function(t){e.$set(e.noticeForm,"title",t)},expression:"noticeForm.title"}})],1),a("el-form-item",{attrs:{label:"内容",prop:"content","label-width":e.formLabelWidth}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4}},model:{value:e.noticeForm.content,callback:function(t){e.$set(e.noticeForm,"content",t)},expression:"noticeForm.content"}})],1),a("el-form-item",{attrs:{label:"是否置顶",prop:"is_top","label-width":e.formLabelWidth}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:e.noticeForm.is_top,callback:function(t){e.$set(e.noticeForm,"is_top",t)},expression:"noticeForm.is_top"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.noticeFormVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",loading:e.noticeLoadingBut},on:{click:function(t){return e.submitNoticeForm()}}},[e._v("确 定")])],1)],1)],1)},o=[],s=(a("ac1f"),a("841c"),a("a15b"),a("c24f")),r={name:"GroupList",data:function(){return{list:null,loading:!1,pages:{total:0,limit:20},search:{id:"",uid:"",name:"",is_dismiss:"",page:1},date_val:"",loadingBut:!1,formLabelWidth:"120px",dialogFormVisible:!1,form:{id:"",name:"",describe:"",is_mute:""},userListVisible:!1,userLoading:!1,userList:[],groupInfo:null,groupdData:null,messageVisible:!1,messageLoading:!1,messageList:[],msgPages:{page:1,total:0,limit:20,message:"",date:""},msgType:{1:"文本消息",2:" 文件消息",3:" 转发消息",4:"代码消息",5:" 投票消息",6:" 群组公告",7:"好友申请",8:" 登录通知消息",9:"入群退群"},noticeVisible:!1,noticeList:[],noticeLoading:!1,noticeData:null,noticePages:{page:1,total:0,limit:20},noticeFormVisible:!1,noticeLoadingBut:!1,noticeForm:{id:"",uid:"",group_id:"",title:"",content:"",is_top:0},dateValue:null,pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]},rules:{}}},created:function(){this.getGroupList()},methods:{onSubmit:function(){this.search.page=1,this.getGroupList()},queryMessage:function(){this.dateValue?this.msgPages.date=this.dateValue.join(","):this.msgPages.date="",this.msgPages.page=1,this.showGroupMessage(this.groupdData)},closeMessageVisible:function(){this.msgPages={page:1,total:0,limit:20,message:"",date:""},this.dateValue=null},showGroupMessage:function(e){var t=this;this.messageVisible=!0,this.messageLoading=!0,this.groupdData=e,Object(s["r"])({group_id:e.id,page:this.msgPages.page,message:this.msgPages.message,date:this.msgPages.date}).then((function(e){var a=e.data;t.messageLoading=!1,t.messageList=a.data.data,t.msgPages.total=a.data.total,t.msgPages.limit=a.data.per_page,t.msgPages.page=a.data.current_page}))},msgeCurrentChange:function(e){this.msgPages.page=e,this.showGroupMessage(this.groupdData)},showGroupNotice:function(e){var t=this;console.log(e),this.noticeVisible=!0,this.noticeLoading=!0,this.noticeData=e,Object(s["l"])({group_id:e.id,uid:e.uid}).then((function(e){var a=e.data;t.noticeLoading=!1,t.noticeList=a.data.data,t.noticePages.total=a.data.total,t.noticePages.limit=a.data.per_page,t.noticePages.page=a.data.current_page,console.log(a)}))},noticeCurrentChange:function(e){this.noticePages.page=e,this.showGroupNotice(this.groupdData)},delNoticeGroup:function(e,t){var a=this;Object(s["c"])({id:t.id,uid:t.uid}).then((function(e){a.showGroupNotice({id:t.group_id,uid:t.uid})}))},groupManager:function(e,t){var a=this,i=0==t.role?"2":"0";Object(s["n"])({group_id:this.groupInfo.id,uid:t.uid+"",is_manager:i}).then((function(e){a.showGroupUsers(1,a.groupInfo)}))},submitNoticeForm:function(){var e=this;this.noticeLoadingBut=!0,this.noticeForm.id>0?Object(s["v"])(this.noticeForm).then((function(t){e.noticeLoadingBut=!1,200==t.data.code&&(e.noticeFormVisible=!1,e.showGroupNotice(e.noticeData))})):Object(s["a"])(this.noticeForm).then((function(t){e.noticeLoadingBut=!1,200==t.data.code&&(e.noticeFormVisible=!1,e.showGroupNotice(e.noticeData))}))},onNoticeAddOrUpdate:function(e,t){this.noticeForm=null,this.noticeFormVisible=!0;var a="",i="";-1==e&&(a=this.noticeData.id,i=this.noticeData.uid),this.noticeForm={id:"",uid:i,group_id:a,title:"",content:"",is_top:0},t&&(this.noticeForm=Object.assign({},t))},getGroupList:function(){var e=this;if(this.loading=!0,this.date_val){var t="";for(var a in this.date_val)t+=this.date_val[a],0==a&&(t+=",");this.search.date=t}else this.search.date="";Object(s["i"])(this.search).then((function(t){var a=t.data;e.loading=!1,e.list=a.data.data,e.pages.total=a.data.total,e.pages.limit=a.data.per_page,e.search.page=a.data.current_page}))},showGroupUsers:function(e,t){var a=this;this.userListVisible=!0,this.userLoading=!0,Object(s["h"])({id:t.id,uid:t.uid}).then((function(e){console.log(e),a.userLoading=!1,a.userList=e.data.data.group_member,a.groupInfo=e.data.data.group_info}))},kickOutGroup:function(e){var t=this,a=this.userList[e];Object(s["o"])({id:a.uid,uid:this.groupInfo.uid,group_id:this.groupInfo.id}).then((function(a){t.showGroupUsers(e,t.groupInfo)}))},muteMemberGroup:function(e){var t=this,a=1==e.is_mute?0:1;Object(s["s"])({uid:e.uid,group_id:this.groupInfo.id,is_mute:a}).then((function(e){console.log(e),t.showGroupUsers(1,t.groupInfo)}))},showGroupInfo:function(e,t){var a=this;this.form={id:"",name:"",describe:"",is_mute:""},this.dialogFormVisible=!0,Object(s["h"])({id:t.id,uid:t.uid}).then((function(e){a.form=e.data.data.group_info,console.log(e)}))},submitForm:function(){var e=this;this.loadingBut=!0,Object(s["u"])(this.form).then((function(t){e.loadingBut=!1,e.dialogFormVisible=!1,e.getGroupList()}))},handleCurrentChange:function(e){this.search.page=e,this.getGroupList()},closeVisible:function(){this.dialogFormVisible=!1}}},n=r,l=a("2877"),u=Object(l["a"])(n,i,o,!1,null,"4b469e68",null);t["default"]=u.exports}}]);